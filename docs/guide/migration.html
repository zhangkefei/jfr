<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>从 v2 迁移 | JFR</title>
    <meta name="description" content="自由的JS包管理平台">
    <link rel="stylesheet" href="/jfr/assets/style.83a29755.css">
    <link rel="modulepreload" href="/jfr/assets/app.e0de481f.js">
    <link rel="modulepreload" href="/jfr/assets/guide_migration.md.d6628da1.lean.js">
    
    <link rel="icon" type="image/svg+xml" href="./diamond.svg">
  <meta property="og:type" content="website">
  <meta property="og:title" content="JFR">
  <meta property="og:image" content="">
  <meta property="og:url" content="https://zhangkefei.github.io/jfr/">
  <script>(()=>{const e=localStorage.getItem("vitepress-theme-appearance"),a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5df46c90><!--[--><span tabindex="-1" data-v-5bad87e6></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-5bad87e6> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5df46c90 data-v-0f827909><div class="VPNavBar has-sidebar" data-v-0f827909 data-v-1f303f99><div class="container" data-v-1f303f99><div class="VPNavBarTitle has-sidebar" data-v-1f303f99 data-v-2f31cfb8><a class="title" href="/jfr/" data-v-2f31cfb8><img class="logo" src="./diamond.svg" data-v-2f31cfb8><!--[-->JFR<!--]--></a></div><div class="content" data-v-1f303f99><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-1f303f99 data-v-1afc9dec><span id="main-nav-aria-label" class="visually-hidden" data-v-1afc9dec>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/jfr/" data-v-1afc9dec data-v-3f7bcea1 data-v-48abdd18><!--[-->首页<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/jfr/guide/" data-v-1afc9dec data-v-3f7bcea1 data-v-48abdd18><!--[-->指引<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/jfr/config/" data-v-1afc9dec data-v-3f7bcea1 data-v-48abdd18><!--[-->配置<!--]--><!----></a><!--]--><!--[--><div class="VPFlyout" data-v-1afc9dec data-v-04a88e88><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04a88e88><span class="text" data-v-04a88e88><!----> 相关链接 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-04a88e88><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-04a88e88><div class="VPMenu" data-v-04a88e88 data-v-e3d492a8><div class="items" data-v-e3d492a8><!--[--><!--[--><div class="VPMenuLink" data-v-e3d492a8 data-v-44c3a200><a class="VPLink link" href="https://" target="_blank" rel="noopener noreferrer" data-v-44c3a200 data-v-48abdd18><!--[-->Awesome JFR<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-48abdd18><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e3d492a8 data-v-44c3a200><a class="VPLink link" href="https://" target="_blank" rel="noopener noreferrer" data-v-44c3a200 data-v-48abdd18><!--[-->更新日志<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-48abdd18><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><div class="VPFlyout VPNavBarTranslations translations" data-v-1f303f99 data-v-36e1defe data-v-04a88e88><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04a88e88><span class="text" data-v-04a88e88><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="option-icon" data-v-04a88e88><path d="M0 0h24v24H0z" fill="none"></path><path d=" M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z " class="css-c4d79v"></path></svg>  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-04a88e88><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-04a88e88><div class="VPMenu" data-v-04a88e88 data-v-e3d492a8><!----><!--[--><!--[--><div class="items" data-v-36e1defe><p class="title" data-v-36e1defe>简体中文</p><!--[--><div class="VPMenuLink" data-v-36e1defe data-v-44c3a200><a class="VPLink link" href="https://zhangkefei.github.io/jfr/" target="_blank" rel="noopener noreferrer" data-v-44c3a200 data-v-48abdd18><!--[-->English<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-48abdd18><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--></div><!--]--><!--]--></div></div></div><div class="VPNavBarAppearance appearance" data-v-1f303f99 data-v-0b2f3bac><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-0b2f3bac data-v-741b6450 data-v-ab2de182><span class="check" data-v-ab2de182><span class="icon" data-v-ab2de182><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-741b6450><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-741b6450><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-1f303f99 data-v-5fe59986 data-v-04a88e88><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04a88e88><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-04a88e88><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-04a88e88><div class="VPMenu" data-v-04a88e88 data-v-e3d492a8><!----><!--[--><!--[--><div class="group" data-v-5fe59986><p class="trans-title" data-v-5fe59986>简体中文</p><!--[--><div class="VPMenuLink" data-v-5fe59986 data-v-44c3a200><a class="VPLink link" href="https://zhangkefei.github.io/jfr/" target="_blank" rel="noopener noreferrer" data-v-44c3a200 data-v-48abdd18><!--[-->English<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-48abdd18><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a></div><!--]--></div><div class="group" data-v-5fe59986><div class="item appearance" data-v-5fe59986><p class="label" data-v-5fe59986>Appearance</p><div class="appearance-action" data-v-5fe59986><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" data-v-5fe59986 data-v-741b6450 data-v-ab2de182><span class="check" data-v-ab2de182><span class="icon" data-v-ab2de182><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-741b6450><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-741b6450><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-1f303f99 data-v-0a484f1e><span class="container" data-v-0a484f1e><span class="top" data-v-0a484f1e></span><span class="middle" data-v-0a484f1e></span><span class="bottom" data-v-0a484f1e></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-5df46c90 data-v-395172d0><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-395172d0><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-395172d0><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-395172d0>Menu</span></button><a class="top-link" href="#" data-v-395172d0> Return to top </a></div><aside class="VPSidebar" data-v-5df46c90 data-v-edcb5950><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-edcb5950><span class="visually-hidden" id="sidebar-aria-label" data-v-edcb5950> Sidebar Navigation </span><!--[--><div class="group" data-v-edcb5950><section class="VPSidebarGroup" data-v-edcb5950 data-v-101c2d58><div class="title" data-v-101c2d58><h2 class="title-text" data-v-101c2d58>指引</h2><div class="action" data-v-101c2d58><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-101c2d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-101c2d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-101c2d58><!--[--><a class="VPLink link" href="/jfr/guide/why.html" data-v-101c2d58 data-v-60e30c69 data-v-48abdd18><!--[--><span class="link-text" data-v-60e30c69>为什么用 JFR</span><!--]--><!----></a><a class="VPLink link" href="/jfr/guide/" data-v-101c2d58 data-v-60e30c69 data-v-48abdd18><!--[--><span class="link-text" data-v-60e30c69>开始</span><!--]--><!----></a><a class="VPLink link" href="/jfr/guide/features.html" data-v-101c2d58 data-v-60e30c69 data-v-48abdd18><!--[--><span class="link-text" data-v-60e30c69>功能</span><!--]--><!----></a><!--]--></div></section></div><div class="group" data-v-edcb5950><section class="VPSidebarGroup" data-v-edcb5950 data-v-101c2d58><div class="title" data-v-101c2d58><h2 class="title-text" data-v-101c2d58>命令</h2><div class="action" data-v-101c2d58><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-101c2d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-101c2d58><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-101c2d58><!--[--><a class="VPLink link" href="/jfr/guide/command-login.html" data-v-101c2d58 data-v-60e30c69 data-v-48abdd18><!--[--><span class="link-text" data-v-60e30c69>登入 login</span><!--]--><!----></a><a class="VPLink link" href="/jfr/guide/command-logout.html" data-v-101c2d58 data-v-60e30c69 data-v-48abdd18><!--[--><span class="link-text" data-v-60e30c69>登出 logout</span><!--]--><!----></a><a class="VPLink link" href="/jfr/guide/command-search.html" data-v-101c2d58 data-v-60e30c69 data-v-48abdd18><!--[--><span class="link-text" data-v-60e30c69>搜索 search</span><!--]--><!----></a><a class="VPLink link" href="/jfr/guide/command-install.html" data-v-101c2d58 data-v-60e30c69 data-v-48abdd18><!--[--><span class="link-text" data-v-60e30c69>安装 install</span><!--]--><!----></a><a class="VPLink link" href="/jfr/guide/command-publish.html" data-v-101c2d58 data-v-60e30c69 data-v-48abdd18><!--[--><span class="link-text" data-v-60e30c69>发布 publish</span><!--]--><!----></a><a class="VPLink link" href="/jfr/guide/command-price.html" data-v-101c2d58 data-v-60e30c69 data-v-48abdd18><!--[--><span class="link-text" data-v-60e30c69>价格 price</span><!--]--><!----></a><!--]--></div></section></div><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5df46c90 data-v-09411f0c><div class="VPDoc has-sidebar" data-v-09411f0c data-v-2558d4fc><div class="container" data-v-2558d4fc><div class="aside" data-v-2558d4fc><div class="aside-curtain" data-v-2558d4fc></div><div class="aside-container" data-v-2558d4fc><div class="aside-content" data-v-2558d4fc><div class="VPDocAside" data-v-2558d4fc data-v-ab3cfea0><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline has-outline" data-v-ab3cfea0 data-v-0adf76b1><div class="content" data-v-0adf76b1><div class="outline-marker" data-v-0adf76b1></div><div class="outline-title" data-v-0adf76b1>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-0adf76b1><span class="visually-hidden" id="doc-outline-aria-label" data-v-0adf76b1> Table of Contents for current page </span><ul class="root" data-v-0adf76b1><!--[--><li style="" data-v-0adf76b1><a class="outline-link" href="#node-support" data-v-0adf76b1>Node 支持</a><!----></li><li style="" data-v-0adf76b1><a class="outline-link" href="#modern-browser-baseline-change" data-v-0adf76b1>现代浏览器基准线变化</a><!----></li><li style="" data-v-0adf76b1><a class="outline-link" href="#config-options-changes" data-v-0adf76b1>配置选项变化</a><!----></li><li style="" data-v-0adf76b1><a class="outline-link" href="#achitecture-changes-and-legacy-options" data-v-0adf76b1>架构变更和兼容选项</a><!----></li><li style="" data-v-0adf76b1><a class="outline-link" href="#dev-server-changes" data-v-0adf76b1>开发服务器变化</a><!----></li><li style="" data-v-0adf76b1><a class="outline-link" href="#build-changes" data-v-0adf76b1>构建变化</a><!----></li><li style="" data-v-0adf76b1><a class="outline-link" href="#ssr-changes" data-v-0adf76b1>SSR Changes</a><!----></li><li style="" data-v-0adf76b1><a class="outline-link" href="#general-changes" data-v-0adf76b1>其他一般性变化</a><!----></li><li style="" data-v-0adf76b1><a class="outline-link" href="#advanced" data-v-0adf76b1>进阶</a><!----></li><li style="" data-v-0adf76b1><a class="outline-link" href="#migration-from-v1" data-v-0adf76b1>从 v1 迁移</a><!----></li><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-ab3cfea0></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-2558d4fc><div class="content-container" data-v-2558d4fc><!--[--><!--]--><main class="main" data-v-2558d4fc><div style="position:relative;" class="vp-doc _jfr_guide_migration" data-v-2558d4fc><div><h1 id="migration-from-v2" tabindex="-1">从 v2 迁移 <a class="header-anchor" href="#migration-from-v2">¶</a></h1><h2 id="node-support" tabindex="-1">Node 支持 <a class="header-anchor" href="#node-support">¶</a></h2><p>Vite 不再支持 Node v12，因为它已经进入了 EOL 阶段。现在你必须使用 Node 14.18+ 及以上版本。</p><h2 id="modern-browser-baseline-change" tabindex="-1">现代浏览器基准线变化 <a class="header-anchor" href="#modern-browser-baseline-change">¶</a></h2><p>生产构建打包时加会假定目标支持现代 JavaScript。默认情况下，Vite 的目标是支持 <a href="https://caniuse.com/es6-module" target="_blank" rel="noopener noreferrer">原生 ES 模块</a>、<a href="https://caniuse.com/es6-module-dynamic-import" target="_blank" rel="noopener noreferrer">原生 ESM 动态导入</a> 以及 <a href="https://caniuse.com/mdn-javascript_statements_import_meta" target="_blank" rel="noopener noreferrer"><code>import.<wbr>meta</code></a> 的浏览器：</p><ul><li>Chrome &gt;=87</li><li>Firefox &gt;=78</li><li>Safari &gt;=13</li><li>Edge &gt;=88</li></ul><p>一小部分用户需要 <a href="https://github.com/vitejs/vite/tree/main/packages/plugin-legacy" target="_blank" rel="noopener noreferrer">@vitejs/plugin-legacy</a>，它会自动生成兼容性 chunk 以及相应的 ES 语言功能的 polyfill。</p><h2 id="config-options-changes" tabindex="-1">配置选项变化 <a class="header-anchor" href="#config-options-changes">¶</a></h2><ul><li><p>下列在 v2 当中我们已经标记为弃用选项，现在已经被移除：</p><ul><li><code>alias</code>（改为了 <a href="./../config/shared-options.html#resolve-alias"><code>resolve.alias</code></a>）</li><li><code>dedupe</code>（改为了 <a href="./../config/shared-options.html#resolve-dedupe"><code>resolve.dedupe</code></a>）</li><li><code>build.base</code>（改为了 <a href="./../config/shared-options.html#base"><code>base</code></a>）</li><li><code>build.brotliSize</code>（改为了 <a href="./../config/build-options.html#build-reportcompressedsize"><code>build.reportCompressedSize</code></a>）</li><li><code>build.cleanCssOptions</code>（Vite 现在使用 esbuild 来做 CSS 最小化压缩）</li><li><code>build.polyfillDynamicImport</code>（在没有支持动态导入的浏览器中，使用 <a href="https://github.com/vitejs/vite/tree/main/packages/plugin-legacy" target="_blank" rel="noopener noreferrer"><code>@vitejs/plugin-legacy</code></a>）</li><li><code>optimizeDeps.keepNames</code>（改为了 <a href="./../config/dep-optimization-options.html#optimizedeps-esbuildoptions"><code>optimizeDeps.esbuildOptions.keepNames</code></a>）</li></ul></li></ul><h2 id="achitecture-changes-and-legacy-options" tabindex="-1">架构变更和兼容选项 <a class="header-anchor" href="#achitecture-changes-and-legacy-options">¶</a></h2><p>这一小节描述了 Vite v3 中最大的架构变更。在项目从 v2 迁移、遇到兼容性问题时，可以使用新添加的兼容选项来恢复到 Vite v2 策略。</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>这些选项曾被标记为实验性，如今已经废弃。它们可能将在 v3 后续版本中被移除，因此使用它们时请固定 Vite 版本。</p><ul><li><code>legacy.devDepsScanner</code></li><li><code>legacy.buildRollupPluginCommonjs</code></li><li><code>legacy.buildSsrCjsExternalHeuristics</code></li></ul></div><h2 id="dev-server-changes" tabindex="-1">开发服务器变化 <a class="header-anchor" href="#dev-server-changes">¶</a></h2><p>Vite 的默认开发服务器端口号现在改为了 5173。你可以使用 <a href="./../config/server-options.html#server-port"><code>server.port</code></a> 将其设置为 3000。</p><p>Vite 的默认开发服务器主机地址现在改为了 <code>localhost</code>。你可以使用 <a href="./../config/server-options.html#server-host"><code>server.host</code></a> 将其设置为 <code>127.0.0.1</code>。</p><p>Vite 使用 esbuild 优化了依赖关系，以将仅提供 CJS 格式的依赖转换成 ESM 格式，并减少浏览器需要请求的模块数量。在 v3 中，检索和批处理依赖的默认策略已经改变。Vite 不再使用 esbuild 预扫描用户代码，以获得冷启动时的初始依赖性列表。取而代之的是将第一次运行依赖性优化推迟到加载时每个导入的用户模块都得到处理之后。</p><p>若想要回到 v2 的策略，你可以使用 <code>legacy.devDepsScanner</code>。</p><h2 id="build-changes" tabindex="-1">构建变化 <a class="header-anchor" href="#build-changes">¶</a></h2><p>在 v3 版本中，Vite 使用 esbuild 来默认优化依赖。这样做的效果是消除了 v2 版中存在的开发和生产环境之间最显著的差异之一。因为 esbuild 将 CJS 格式转换为了 ESM 格式，因此我们不再使用 <a href="https://github.com/rollup/plugins/tree/master/packages/commonjs" target="_blank" rel="noopener noreferrer"><code>@rollupjs/plugin-commonjs</code></a> 了。</p><p>若想要回到 v2 的策略，你可以使用 <code>legacy.buildRollupPluginCommonjs</code>。</p><h2 id="ssr-changes" tabindex="-1">SSR Changes <a class="header-anchor" href="#ssr-changes">¶</a></h2><p>Vite v3 默认在 SSR 构建时使用 ESM 格式。当使用 ESM 时，<a href="https://vitejs.dev/guide/ssr.html#ssr-externals" target="_blank" rel="noopener noreferrer">SSR 外部化的启发式方法</a> 将不再需要。默认情况下所有的依赖都将被外部化。你可以使用 <a href="./../config/ssr-options.html#ssrnoexternal"><code>ssr.noExternal</code></a> 来控制哪些依赖需要被包含进 SSR 的打包产物中。</p><p>如果你无法在你的 SSR 项目中使用 ESM，你可以设置 <code>ssr.format: &#39;cjs&#39;</code> 来生成一个 CJS 格式的产物。在这种情况下，会使用和 Vite v2 相同的外部化策略。</p><p>同样 <a href="https://rollupjs.org/guide/en/#outputinlinedynamicimports" target="_blank" rel="noopener noreferrer"><code>build.rollupOptions.output.inlineDynamicImports</code></a> 现在在 <code>ssr.target</code> 是 <code>node</code> 时，也默认置为了 <code>false</code>。<code>inlineDynamicImports</code> 它会改变执行顺序，并且 node 构建不需要打包到单个文件。</p><h2 id="general-changes" tabindex="-1">其他一般性变化 <a class="header-anchor" href="#general-changes">¶</a></h2><ul><li>SSR 和库模式中将会根据语法格式和包的类型，为输出的 JS 文件提供一个更合理的文件扩展名（<code>js</code>、<code>mjs</code> 或是 <code>cjs</code>）。</li><li>Terser 现在是一个可选依赖。如果你使用的是 <code>build.minify: &#39;terser&#39;</code>，你需要手动安装它：<div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">npm add -D terser</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li></ul><h3 id="importmetaglob" tabindex="-1"><code>import.<wbr>meta.glob</code> <a class="header-anchor" href="#importmetaglob">¶</a></h3><ul><li><p><a href="./features.html#glob-import-as">原始 <code>import.<wbr>meta.glob</code></a> 从 <code>{ assert: { type: &#39;raw&#39; }}</code> 迁移为 <code>{ as: &#39;raw&#39; }</code></p></li><li><p><code>import.<wbr>meta.glob</code> 的 key 现在是相对与当前模块。</p><div class="language-diff"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">// 文件：/foo/index.js</span></span>
<span class="line"><span style="color:#A6ACCD;">const modules = import.<wbr>meta.glob(&#39;../foo/*.js&#39;)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">// 转换为：</span></span>
<span class="line"><span style="color:#A6ACCD;">const modules = {</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">  &#39;../foo/bar.js&#39;: () =&gt; {}</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">  &#39;./bar.js&#39;: () =&gt; {}</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"></span></code></pre></div></li><li><p>当在 <code>import.<wbr>meta.glob</code> 中使用别名（alias）时，键值总是绝对路径。</p></li><li><p><code>import.<wbr>meta.globEager</code> 已经弃用，请使用 <code>import.<wbr>meta.glob(&#39;*&#39;, { eager: true })</code> 来代替。</p></li></ul><h3 id="webassembly-support" tabindex="-1">WebAssembly 支持 <a class="header-anchor" href="#webassembly-support">¶</a></h3><p><code>import init from &#39;example.wasm&#39;</code> 语法被弃用，以防止将来与 <a href="https://github.com/WebAssembly/esm-integration" target="_blank" rel="noopener noreferrer">&quot;WASM 的 ESM 集成&quot;</a> 冲突。</p><p>你可以使用 <code>?init</code> 参数，和之前的行为类似：</p><div class="language-diff"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">import init from &#39;example.wasm&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">import init from &#39;example.wasm?init&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">init().then((instance) =&gt; {</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">init().then(({ exports }) =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">  exports.test()</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span>
<span class="line"></span></code></pre></div><h2 id="advanced" tabindex="-1">进阶 <a class="header-anchor" href="#advanced">¶</a></h2><p>下列改动仅会影响到插件/工具的作者：</p><ul><li><a href="https://github.com/vitejs/vite/pull/5868" target="_blank" rel="noopener noreferrer">[#5868] refactor: remove deprecated api for 3.0</a><ul><li><code>printHttpServerUrls</code> 被移除</li><li><code>server.app</code>、<code>server.transformWithEsbuild</code> 被移除</li><li><code>import.<wbr>meta.hot.acceptDeps</code> 被移除</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/6901" target="_blank" rel="noopener noreferrer">[#6901] fix: sequential injection of tags in transformIndexHtml</a><ul><li><code>transformIndexHtml</code> 现在会从更早的插件处获取到正确的内容，因此，现在注入的标签的顺序与预期的一样。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/7995" target="_blank" rel="noopener noreferrer">[#7995] chore: do not fixStacktrace</a><ul><li><code>ssrLoadModule</code> 的 <code>fixStacktrace</code> 选项现在默认为 <code>false</code></li></ul></li><li><a href="https://github.com/vitejs/vite/pull/8178" target="_blank" rel="noopener noreferrer">[#8178] feat!: migrate to ESM</a><ul><li><code>formatPostcssSourceMap</code> 现在是异步的</li><li><code>resolvePackageEntry</code>、<code>resolvePackageData</code> 在 CJS 构建中将不再可用（需要在 CJS 中使用动态导入）</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/8626" target="_blank" rel="noopener noreferrer">[#8626] refactor: type client maps</a><ul><li><code>import.<wbr>meta.hot.accept</code> 的回调函数类型现在更严格了。现在是 <code>(mod: (Record&lt;string, any&gt; &amp; { [Symbol.toStringTag]: &#39;Module&#39; }) | undefined) =&gt; void</code>（之前是 <code>(mod: any) =&gt; void</code>）。</li></ul></li></ul><p>此外，还有其他一些只影响少数用户的破坏性变化。</p><ul><li><a href="https://github.com/vitejs/vite/pull/5018" target="_blank" rel="noopener noreferrer">[#5018] feat: enable <code>generatedCode: &#39;es2015&#39;</code> for rollup build</a><ul><li>转义到 ES5 现在是必要的，即使用户代码仅含 ES5。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/7877" target="_blank" rel="noopener noreferrer">[#7877] fix: vite client types</a><ul><li><code>/// &lt;reference lib=&quot;dom&quot; /&gt;</code> 已从 <code>vite/client.d.ts</code> 中移除。必须在 <code>tsconfig.json</code> 使用 <code>{ &quot;lib&quot;: [&quot;dom&quot;] }</code> 或 <code>{ &quot;lib&quot;: [&quot;webworker&quot;] }</code>。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/8090" target="_blank" rel="noopener noreferrer">[#8090] feat: preserve process env vars in lib build</a><ul><li><code>process.<wbr>env.*</code> 现在在库模式下是被保留的了。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/8280" target="_blank" rel="noopener noreferrer">[#8280] feat: non-blocking esbuild optimization at build time</a><ul><li><code>server.force</code> 选项现已移除，改为了直接的 <code>force</code> 选项。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/8550" target="_blank" rel="noopener noreferrer">[#8550] fix: dont handle sigterm in middleware mode</a><ul><li>当以中间件模式运行时，Vite 不再在 <code>SIGTERM</code> 强制杀进程。</li></ul></li><li><a href="https://github.com/vitejs/vite/pull/8647" target="_blank" rel="noopener noreferrer">[#8647] feat: print resolved address for localhost</a><ul><li><code>server.printUrls</code> 和 <code>previewServer.printUrls</code> 现在是异步的了。</li></ul></li></ul><h2 id="migration-from-v1" tabindex="-1">从 v1 迁移 <a class="header-anchor" href="#migration-from-v1">¶</a></h2><p>在 Vite v2 文档中查看 <a href="https://v2.vitejs.dev/guide/migration.html" target="_blank" rel="noopener noreferrer">Migration from v1 Guide</a>（<a href="https://cn.vitejs.dev/guide/migration-from-v1.html" target="_blank" rel="noopener noreferrer">中文版</a>），了解如何将你的应用迁移到 Vite v2，然后再处理本页中所提及的变化。</p></div></div></main><footer class="VPDocFooter" data-v-2558d4fc data-v-aa1db44a><div class="edit-info" data-v-aa1db44a><!----><!----></div><div class="prev-next" data-v-aa1db44a><div class="pager" data-v-aa1db44a><!----></div><div class="pager" data-v-aa1db44a><a class="pager-link next" href="/jfr/guide/why.html" data-v-aa1db44a><span class="desc" data-v-aa1db44a>Next page</span><span class="title" data-v-aa1db44a>为什么用 JFR</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-5df46c90 data-v-32972742><div class="container" data-v-32972742><p class="message" data-v-32972742>根据 MIT 许可证发布</p><p class="copyright" data-v-32972742>Copyright © 2022 HIBIT &amp; JFR Contributors</p></div></footer></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"readme.md\":\"366652e1\",\"blog_announcing-vite2.md\":\"e9bac4da\",\"config_build-options.md\":\"2a17d089\",\"config_dep-optimization-options.md\":\"2b78afa7\",\"config_index.md\":\"22a1baf4\",\"config_preview-options.md\":\"8f260ef4\",\"config_server-options.md\":\"fe64ba65\",\"config_shared-options.md\":\"d95782c2\",\"config_ssr-options.md\":\"d0bea312\",\"config_worker-options.md\":\"1e125360\",\"guide_api-hmr.md\":\"d3f92000\",\"guide_api-javascript.md\":\"9e461803\",\"guide_api-plugin.md\":\"e8c13289\",\"guide_assets.md\":\"fdcd5f79\",\"guide_backend-integration.md\":\"88c763c8\",\"guide_build.md\":\"6ecedbb5\",\"guide_comparisons.md\":\"2dc0bb70\",\"guide_dep-pre-bundling.md\":\"8c3fd572\",\"guide_env-and-mode.md\":\"86976494\",\"guide_features.md\":\"00c73813\",\"guide_index.md\":\"b970c489\",\"guide_migration-from-v1.md\":\"87966f88\",\"guide_migration.md\":\"d6628da1\",\"guide_ssr.md\":\"e1a06a51\",\"guide_static-deploy.md\":\"77b7cc2a\",\"guide_using-plugins.md\":\"977eca38\",\"guide_why.md\":\"21609cff\",\"index.md\":\"2404a663\",\"plugins_index.md\":\"d5a1b5a7\"}")</script>
    <script type="module" async src="/jfr/assets/app.e0de481f.js"></script>
    
  </body>
</html>